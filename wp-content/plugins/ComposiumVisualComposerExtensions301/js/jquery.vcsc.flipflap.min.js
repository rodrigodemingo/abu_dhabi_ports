"undefined"==typeof delegate&&(delegate=function(t,e){return function(){return t.apply(e,arguments)}}),Date.now=Date.now||function(){return(new Date).getTime()},"undefined"==typeof console&&(console={}),"function"!=typeof console.log&&(console.log=function(){}),function(){for(var t=0,e=["ms","moz","webkit","o"],s=0;s<e.length&&!window.requestAnimationFrame;++s)window.requestAnimationFrame=window[e[s]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[s]+"CancelAnimationFrame"]||window[e[s]+"CancelRequestAnimationFrame"];void 0===window.requestAnimationFrame&&(window.requestAnimationFrame=function(e){var s=Date.now(),i=Math.max(0,16-(s-t)),n=window.setTimeout(function(){e(s+i)},i);return t=s+i,n}),window.cancelAnimationFrame=window.cancelAnimationFrame||function(t){window.clearTimeout(t)}}(),function(t){function e(e){this.settings=e,this.domObject=document.createElement("div"),t(this.domObject).css("-webkit-transform-style","preserve-3d").css("-moz-transform-style","preserve-3d").css("-ms-transform-style","preserve-3d").css("-o-transform-style","preserve-3d").css("transform-style","preserve-3d").addClass("ts-splitflap-char"),this.upperObject=document.createElement("div"),this.lowerObject=document.createElement("div"),this.flippingObject=document.createElement("div"),t(this.upperObject).width(this.settings.charWidth).height(this.settings.charHeight>>1).css("background-image","url("+this.settings.image+")").addClass("upper"),t(this.lowerObject).width(this.settings.charWidth).height(this.settings.charHeight>>1).css("background-image","url("+this.settings.image+")").addClass("lower"),t(this.flippingObject).width(this.settings.charWidth).height(this.settings.charHeight>>1).css("background-image","url("+this.settings.image+")").css("position","absolute").css("left",0).css("top",0).hide().addClass("flipping"),t(this.domObject).append(this.upperObject),t(this.domObject).append(this.lowerObject),t(this.domObject).append(this.flippingObject)}function s(e){this.settings=e,this.domObject=document.createElement("div"),this.letters=new Array,t(this.domObject).addClass("ts-splitflap-letters")}var i=e.prototype;i.getDOMObject=function(){return this.domObject},i.setChar=function(e,s,i){"undefined"==typeof i&&(i=1);var n=this.settings.charsMap.indexOf(e);if(t(this.upperObject).css("background-position","-"+n*this.settings.charWidth+"px 0px"),i>=1)t(this.lowerObject).css("background-position","-"+n*this.settings.charWidth+"px -"+(this.settings.charHeight>>1)+"px"),t(this.flippingObject).hide();else if(0>=i){var r=this.settings.charsMap.indexOf(s);t(this.upperObject).css("background-position","-"+r*this.settings.charWidth+"px 0px"),t(this.lowerObject).css("background-position","-"+r*this.settings.charWidth+"px -"+(this.settings.charHeight>>1)+"px"),t(this.flippingObject).hide()}else{var r=this.settings.charsMap.indexOf(s);t(this.lowerObject).css("background-position","-"+r*this.settings.charWidth+"px -"+(this.settings.charHeight>>1)+"px");var a;.5>i?(a=180*i,t(this.flippingObject).css("top",0).css("z-index",Math.round(a)).css("-webkit-transform","rotateX(-"+a+"deg)").css("-moz-transform","rotateX(-"+a+"deg)").css("-ms-transform","rotateX(-"+a+"deg)").css("-o-transform","rotateX(-"+a+"deg)").css("transform","rotateX(-"+a+"deg)").css("-webkit-transform-origin","bottom center 0").css("-moz-transform-origin","bottom center 0").css("-ms-transform-origin","bottom center 0").css("-o-transform-origin","bottom center 0").css("transform-origin","bottom center 0").css("background-position","-"+r*this.settings.charWidth+"px 0px")):(a=180*(1-i),t(this.flippingObject).css("top",(this.settings.charHeight>>1)+"px").css("z-index",Math.round(a)).css("-webkit-transform","rotateX("+a+"deg)").css("-moz-transform","rotateX("+a+"deg)").css("-ms-transform","rotateX("+a+"deg)").css("-o-transform","rotateX("+a+"deg)").css("transform","rotateX("+a+"deg)").css("-webkit-transform-origin","top center 0").css("-moz-transform-origin","top center 0").css("-ms-transform-origin","top center 0").css("-o-transform-origin","top center 0").css("transform-origin","top center 0").css("background-position","-"+n*this.settings.charWidth+"px -"+(this.settings.charHeight>>1)+"px")),t(this.flippingObject).show()}};var n=s.prototype;n.getDOMObject=function(){return this.domObject},n.build=function(s,i){$column=i.width(),$maximum=Math.floor($column/this.settings.charWidth),t(this.domObject).css("position","relative"),t(this.domObject).width(s*this.settings.charWidth<$column?s*this.settings.charWidth:$maximum>s?s*this.settings.charWidth:$maximum*this.settings.charWidth);for(var n=0;s>n;n++){var r=new e(this.settings),a=r.getDOMObject(),o=this.settings.text.charAt(n);t(a).css("position","relative"),t(a).attr("data-order",n),t(a).attr("data-letter",o),t(a).attr("data-index",this.settings.charsMap.indexOf(o)),t(this.domObject).append(a),this.letters[n]=r}},n.setText=function(t,e){var s;for("undefined"==typeof e?(e=t,s=!1):s=!0;e.length<this.letters.length;)"left"==this.settings.padDir?e+=this.settings.padChar:e=this.settings.padChar+e;for(var i=new String(e).split(""),n=0,r=this.letters.length;r>n;n++){var a=this.letters[n];a.setChar(i[n])}if(s){for(;t.length<this.letters.length;)"left"==this.settings.padDir?t+=this.settings.padChar:t=this.settings.padChar+t;var o=new String(t).split("");this.animation={time:(new Date).getTime(),letters:new Array};for(var n=0,r=this.letters.length;r>n;n++){for(var h={ratio:0,speed:this.settings.speed+Math.random()*this.settings.speedVariation,letters:new Array(i[n])},c=this.settings.charsMap.indexOf(i[n]);this.settings.charsMap.charAt(c)!=o[n];)c=(c+1)%this.settings.charsMap.length,h.letters.push(this.settings.charsMap.charAt(c));this.animation.letters[n]=h}this.animate()}},n.delayText=function(t,e){for("undefined"==typeof e&&(e=t);e.length<this.letters.length;)"left"==this.settings.padDir?e+=this.settings.padChar:e=this.settings.padChar+e;for(var s=new String(e).split(""),i=0,n=this.letters.length;n>i;i++){var r=this.letters[i];r.setChar(s[i])}},n.animate=function(){for(var t=(new Date).getTime(),e=.001*(t-this.animation.time),s=0,i=0,n=this.animation.letters.length;n>i;i++){var r=this.letters[i],a=this.animation.letters[i];a.letters.length>1&&(a.ratio+=a.speed*e,a.ratio>1&&a.letters.length>1&&(a.ratio=0,a.letters.shift())),a.letters.length>1?(r.setChar(a.letters[1],a.letters[0],a.ratio),s++):r.setChar(a.letters[0])}this.animation.time=t,s>0&&requestAnimationFrame(delegate(this.animate,this))},t.fn.TS_VCSC_SplitFlap=function(e){var i=t.extend({text:"",delay:0,restart:!0,image:"images/ts-flipflap-chars-large.png",charsMap:"ABCDEFGHIJKLMNOPQRSTUVWXYZ 0123456789.,!?#@()+-=",charWidth:50,charHeight:100,padDir:"left",padChar:" ",speed:3,speedVariation:2},e);return this.each(function(){for(var e=t(this),n=new String(e.html()).toUpperCase(),r="",a=0,o=n.length;o>a;a++)r+=i.charsMap.charAt(Math.floor(i.charsMap.length*Math.random()));var h=new s(i);h.build(n.length,e),e.empty().append(h.getDOMObject()),this.splitflap=h,i.delay>0?(h.delayText(n,r),setTimeout(function(){h.setText(n,r,!0),i.restart&&e.on("mousedown touchend",function(){h.setText(n,r,!1)})},i.delay)):(h.setText(n,r,!1),i.restart&&e.on("mousedown touchend",function(){h.setText(n,r,!1)})),jQuery(window).on("debouncedresize",function(){var t=e.width(),s=Math.floor(t/i.charWidth),r=e.find(".ts-splitflap-letters");r.width(n.length*i.charWidth<t?n.length*i.charWidth:s>n.length?n.length*i.charWidth:s*i.charWidth)})})}}(jQuery);