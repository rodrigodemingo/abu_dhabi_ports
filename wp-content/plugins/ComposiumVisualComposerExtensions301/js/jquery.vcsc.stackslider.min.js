!function(t,e){"use strict";var i=t(e),a=(t(document),e.Modernizr);t.StackSlider=function(e,i){this.$stack=t(i).hide(),this._init(e),this.$maxPileHeight=0},t.StackSlider.defaults={speed:600,easing:"ease-in-out",piles:!0,autoheight:!0},t.StackSlider.prototype={_init:function(e){this.options=t.extend(!0,{},t.StackSlider.defaults,e),this.support=a.csstransitions&&a.csstransforms3d;var i={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},r={WebkitTransform:"-webkit-transform",MozTransform:"-moz-transform",OTransform:"-o-transform",msTransform:"-ms-transform",transform:"transform"};this.support&&(this.transEndEventName=i[a.prefixed("transition")]+".stackslider",this.transformName=r[a.prefixed("transform")]),this.current=0;var s=this;return s._layout(),0===s.itemsCount?!1:(s._initEvents(),void 0)},_layout:function(){var e=this.$stack.children("li");this.itemsCount=e.length,this.$wrapper=t('<div class="st-wrapper"></div>'),this.options.piles&&(this.$lPile=t('<div class="st-stack st-stack-left"></div>'),this.$rPile=t('<div class="st-stack st-stack-right"></div>'),this.$wrapper.append(this.$lPile,this.$rPile)),this.$title=t('<div class="st-title"></div>').appendTo(this.$wrapper),this.itemsCount>1&&(this.$navigation=t('<div class="nav"><span class="st-first">First</span><span class="st-prev">Previous</span><span class="st-next">Next</span><span class="st-last">Last</span></div>'),this.$wrapper.append(this.$navigation));var i="";e.each(function(){var e=t(this);i+='<div class="st-item" data-title="'+e.children("div.st-title").html()+'">'+e.children("div.st-item").html()+"</div>"}),this.$listitems=t('<div class="st-item-list"></div>').html(i),this.$items=this.$listitems.children("div").hide(),this.$wrapper.insertAfter(this.$stack).prepend(this.$listitems),this.$stack.remove(),this.options.piles&&this.$rPile.css("height","+="+5*(this.itemsCount-1)),this._setSize(),this._initItems()},_setSize:function(){var t=this.$items.height(),e=1.25*t;this.radius=this.$wrapper.width()/2-e/2,this.options.piles&&(this.$lPile.css("width","25%"),this.$rPile.css("width","25%"))},_initEvents:function(){var t=this;this.$navigation.children("span.st-next").on({"mousedown.stackslider":function(){t._navigate("next"),t.startflowtimeout=setTimeout(function(){t.flow=!0,t._flow("next")},600)},"mouseup.stackslider mouseleave.stackslider":function(){t._mouseup("next")}}).end().children("span.st-prev").on({"mousedown.stackslider":function(){t._navigate("prev"),t.startflowtimeout=setTimeout(function(){t.flow=!0,t._flow("prev")},600)},"mouseup.stackslider mouseleave.stackslider":function(){t._mouseup("prev")}}).end().children("span.st-first").on({"mousedown.stackslider":function(){t._navigate("first"),t.startflowtimeout=setTimeout(function(){t.flow=!0,t._flow("first")},600),t._mouseup("first")}}).end().children("span.st-last").on({"mousedown.stackslider":function(){t._navigate("last"),t.startflowtimeout=setTimeout(function(){t.flow=!0,t._flow("last")},600),t._mouseup("last")}}),i.on("debouncedresize.stackslider",function(){t._setSize(),t._initItems()})},_mouseup:function(t){var e=this;clearTimeout(this.startflowtimeout),clearTimeout(this.flowtimeout),this.flow&&(setTimeout(function(){0!==e.current&&e.current!==e.itemsCount-1&&e._navigate(t)},100),this.flow=!1)},_flow:function(t){var e=this;this._navigate(t,!0),this.flowtimeout=setTimeout(function(){e._flow(t)},150)},_navigate:function(e,i){var a,r,s,n,o,u=this,l="st-left st-center st-right st-leftflow st-rightflow",d=this.$items.eq(this.current),c=this.$wrapper,h=this.$lPile,p=this.$rPile,f=h.height()+p.height(),m=this.options.autoheight,y=this.itemsCount;if("next"===e&&this.current<this.itemsCount-1)++this.current,r="st-left",a=i?"st-leftflow":r,s="right",n="left",o="normal";else if("prev"===e&&this.current>0)--this.current,r="st-right",a=i?"st-rightflow":r,s="left",n="right",o="normal";else if("first"===e&&this.current>0)this.current=0,r="st-right",a=i?"st-rightflow":r,s="left",n="right",o="circle";else{if(!("last"===e&&this.current<this.itemsCount-1))return!1;this.current=this.itemsCount-1,r="st-left",a=i?"st-leftflow":r,s="right",n="left",o="circle"}this._updatePile(s,"out",o,y);var g=this.$items.eq(this.current);d.removeClass(l).addClass(a),this.support?d.on(this.transEndEventName,function(){t(this).removeClass(l).addClass(r).off(u.transEndEventName),u._updatePile(n,"in",o,y)}):(d.removeClass(l).addClass(r),this._updatePile(n,"in",o,y)),g.show(),setTimeout(function(){(i&&(0===u.current||u.current===u.itemsCount-1)||!i)&&(g.removeClass(l).addClass("st-center"),m&&c.height(g.find("img").height()+f+25))},25),clearTimeout(this.titletimeout);var v=this.support?this.options.speed:0;this.titletimeout=setTimeout(function(){u.$title.html(g.data("title"))},v)},_updatePile:function(t,e,i,a){return this.options.piles?("right"===t&&"normal"===i?this.$rPile.css("height","in"===e?"+=5":"-=5"):"left"===t&&"normal"===i?this.$lPile.css("height","in"===e?"+=5":"-=5"):"left"===t&&"circle"===i?this.$lPile.css("height","in"===e?5*a-5:"5"):"right"===t&&"circle"===i&&this.$rPile.css("height","in"===e?5*a-5:"5"),void 0):!1},_initItems:function(){var e=this,i=this.$wrapper.width(),a=this.$wrapper.height(),r=this.$items.eq(this.current).addClass("st-center").show(),s=this.options.piles?Math.max(this.$lPile.height(),this.$rPile.height())/2:0,n=this.$lPile.height()+this.$rPile.height(),o=0;this.$title.html(r.data("title")),this.$items.each(function(){var r=t(this),n=r.find("img").height(),u=r.width();a-e.radius-n/2,r.index()!==e.current&&r.addClass("st-right"),r.find("img").attr("data-stack",i/r.find("img").attr("data-ratio")),i/r.find("img").attr("data-ratio")>o&&(o=i/r.find("img").attr("data-ratio")),e.support&&r.css({transition:e.transformName+" "+e.options.speed+"ms "+e.options.easing+", opacity "+e.options.speed+"ms "+e.options.easing,transformOrigin:"50% "+(e.radius+n/2-s)+"px"}),r.css({left:i/2-u/2,top:0})}),this.options.autoheight?this.$wrapper.height(r.find("img").height()+n+25):this.$wrapper.height(o+n+25)}};var r=function(t){e.console&&e.console.error(t)};t.fn.stackslider=function(e){var i=t.data(this,"stackslider");if("string"==typeof e){var a=Array.prototype.slice.call(arguments,1);this.each(function(){return i?t.isFunction(i[e])&&"_"!==e.charAt(0)?(i[e].apply(i,a),void 0):(r("no such method '"+e+"' for stackslider instance"),void 0):(r("cannot call methods on stackslider prior to initialization; attempted to call method '"+e+"'"),void 0)})}else this.each(function(){i?(alert("Already Initialized!"),i._init()):i=t.data(this,"stackslider",new t.StackSlider(e,this))});return i}}(jQuery,window);